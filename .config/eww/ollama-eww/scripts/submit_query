#!/bin/bash

# File to save conversation history
conversation_file="$HOME/.config/eww/ollama-eww/ollama_conversation.txt"

# Read the input text
input_text=$(eww get input_text)

# Make an API call to Ollama
response=$(curl -s -X POST "https://api.ollama.com/endpoint" \
  -H "Content-Type: application/json" \
  -d "{\"query\":\"$input_text\"}")

# Append the input and response to the conversation file
echo "You: $input_text" >> "$conversation_file"
echo "Ollama: $response" >> "$conversation_file"
echo "" >> "$conversation_file"

# Update the Eww widget with the conversation history
conversation_history=$(cat "$conversation_file")
eww update ollama_output="$conversation_history"
